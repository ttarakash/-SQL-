CREATE TABLE publishers (
    id SERIAL PRIMARY KEY,
    name TEXT NOT NULL
);

CREATE TABLE books (
    id serial primary key,
    title text not null,
    publisher_id int,
    format text check (format in ('твердый', 'мягкий')),
    pages INT,
    published_date DATE DEFAULT CURRENT_DATE,
    FOREIGN KEY (publisher_id) REFERENCES publishers(id)
);

create table authors (
 id serial primary key,
 name text not null,
 country text not null,
 birthdate date check (birthdate < current_date)
);

create table authors_books (
 author_id int,
 books_id int,
 FOREIGN KEY (author_id) REFERENCES authors(id),
 FOREIGN KEY (books_id) REFERENCES books (id)
);

create table translator (
 id serial primary key,
 name text not null
);

create table translator_books (
 translator_id int,
 book_id int,
 foreign key (translator_id) references translator (id),
 foreign key (book_id) references books (id)
);

create table rating (
 book_id int,
 rating int,
 foreign key (book_id) references books (id)
);

INSERT INTO publishers (name) 
VALUES
('And Other Stories'),
('Charco Press'),
('Europa Editions'),
('Faber & Faber'),
('Fitzcarraldo Editions'),
('Granta Books'),
('Harvill Secker'),
('Honford Star'),
('Jonathan Cape'),
('Literatura Random House'),
('Lolli Editions'),
('MacLehose Press'),
('Oneworld'),
('Peirene Press'),
('Picador'),
('Portobello Books'),
('Pushkin Press'),
('Riverrun'),
('Sandstone Press'),
('Scribe UK'),
('Scribner'),
('Seagull Books'),
('Serpent''s Tail'),
('Text Publishing'),
('The New Press'),
('Tilted Axis Press'),
('Transit Books'),
('Tuskar Rock'),
('Verso Fiction'),
('W&N'),
('William Heinemann'),
('World Editions'),
('Yale University Press');

select * from publishers;

INSERT INTO authors (name, country, birthdate) 
VALUES
('Адания Шибли', 'Палестина', '1974-01-01'),
('Ахмед Саадави', 'Ирак', '1973-01-01'),
('Алия Трабукко Зеран', 'Чили', '1983-01-01'),
('Аманда Свенссон', 'Швеция', '1987-01-01'),
('Андрей Курков', 'Украина', '1961-01-01'),
('Анджей Тихи', 'Швеция', '1978-01-01'),
('Анни Эрно', 'Франция', '1940-01-01'),
('Антонио Муньос Молина', 'Испания', '1956-01-01'),
('Ариана Арвис', 'Аргентина', '1977-01-01'),
('Бенхамин Лабатут', 'Чили', '1980-01-01'),
('Бора Чхун', 'Южная Корея', '1976-01-01'),
('Цзань Сюэ', 'Китай', '1953-01-01'),
('Чон Мён-гван', 'Южная Корея', '1964-01-01'),
('Кристоф Рансмайр', 'Австрия', '1954-01-01'),
('Клаудия Пиньейро', 'Аргентина', '1960-01-01'),
('Клеменс Майер', 'Германия', '1977-01-01'),
('Даниэль Кельманн', 'Германия', '1975-01-01'),
('Давид Диоп', 'Франция', '1966-01-01'),
('Давид Гроссман', 'Израиль', '1954-01-01'),
('Эмманюэль Паганно', 'Франция', '1969-01-01'),
('Энрике Вила-Матас', 'Испания', '1948-01-01'),
('Эрик Вюйяр', 'Франция', '1968-01-01'),
('Ева Балтасар', 'Испания', '1978-01-01'),
('Фернанда Мельчор', 'Мексика', '1982-01-01'),
('Габриэла Кабесон Камара', 'Аргентина', '1968-01-01'),
('Габриэла Ибарра', 'Испания', '1983-01-01'),
('Гоз', 'Кот-д’Ивуар', '1971-01-01'),
('Гитанджали Шри', 'Индия', '1957-01-01'),
('Георги Господинов', 'Болгария', '1968-01-01'),
('Гуадалупе Нетель', 'Мексика', '1973-01-01'),
('Хан Кан', 'Южная Корея', '1970-01-01'),
('Юбер Мингарелли', 'Франция', '1956-01-01'),
('Хван Сог-ён', 'Южная Корея', '1943-01-01'),
('Яап Роббен', 'Нидерланды', '1984-01-01'),
('Хавьер Серкас', 'Испания', '1962-01-01'),
('Йенни Эрпенбек', 'Германия', '1967-01-01'),
('Джоха Аль-Харти', 'Оман', '1978-01-01'),
('Йон Фоссе', 'Норвегия', '1959-01-01'),
('Йонас Эйка', 'Дания', '1991-01-01'),
('Хуан Габриэль Васкес', 'Колумбия', '1973-01-01'),
('Юдит Шалански', 'Германия', '1980-01-01'),
('Ласло Краснагоркаи', 'Венгрия', '1954-01-01'),
('Лоран Бине', 'Франция', '1972-01-01'),
('Лоран Мовинье', 'Франция', '1967-01-01'),
('Мария Степанова', 'Россия', '1972-01-01'),
('Мариана Энрикес', 'Аргентина', '1973-01-01'),
('Марийке Лукас Рейнвельд', 'Нидерланды', '1991-01-01'),
('Марион Пошманн', 'Германия', '1969-01-01'),
('Мариз Конде', 'Франция', '1937-01-01'),
('Мазен Мааруф', 'Ливан', '1978-01-01'),
('Мишель Уэльбек', 'Франция', '1956-01-01'),
('Миэко Каваками', 'Япония', '1976-01-01'),
('Нана Эквтимишвили', 'Грузия', '1978-01-01'),
('Нгуги ва Тхионго', 'Кения', '1938-01-01'),
('Нино Харатишвили', 'Грузия', '1983-01-01'),
('Норман Эриксон Пасарибу', 'Индонезия', '1990-01-01'),
('Ольга Равн', 'Дания', '1986-01-01'),
('Ольга Токарчук', 'Польша', '1962-01-01'),
('Пауло Скотт', 'Бразилия', '1966-01-01'),
('Пеэрумал Муруган', 'Индия', '1966-01-01'),
('Саманта Швеблин', 'Аргентина', '1978-01-01'),
('Пак Санъён', 'Южная Корея', '1988-01-01'),
('Сара Стридсберг', 'Швеция', '1972-01-01'),
('Шокуфе Азар', 'Иран', '1972-01-01'),
('Томми Виринга', 'Нидерланды', '1967-01-01'),
('Вигдис Хьёрт', 'Норвегия', '1959-01-01'),
('Виоленн Юисман', 'Франция', '1979-01-01'),
('Виржини Депант', 'Франция', '1969-01-01'),
('Виллем Анкер', 'Южная Африка', '1979-01-01'),
('У Минъи', 'Тайвань', '1971-01-01'),
('Ёко Огава', 'Япония', '1962-01-01'),
('Цзоу Цзинчжи', 'Китай', '1952-01-01');

INSERT INTO books (title, publisher_id, format, pages, published_date) VALUES
('Валун', 10, 'мягкий', 112, '2022-08-02'),
('Кит', 3, 'мягкий', 368, '2023-01-19'),
('Евангелие по Новому миру', 32, 'мягкий', 184, '2023-03-07'),
('Стоящий тяжело', 12, 'мягкий', 252, '2022-05-26'),
('Убежище времени', 30, 'твердый', 304, '2022-04-21'),
('Мать умерла?', 29, 'мягкий', 330, '2022-09-27'),
('Джимми Хендрикс живьём во Львове', 12, 'твердый', 416, '2023-04-27'),
('День рождения', 27, 'мягкий', 454, '2023-01-24'),
('Пока мы мечтали', 5, 'мягкий', 528, '2023-03-30'),
('Костёр', 17, 'мягкий', 224, '2022-04-08'),
('Едва рождённый', 5, 'мягкий', 200, '2022-06-22'),
('Система столь великолепная, что ослепляет', 20, 'мягкий', 544, '2023-03-09'),
('Девятое здание', 8, 'мягкий', 272, '2022-05-16'),
('Парадайс', 5, 'мягкий', 118, '2022-03-23'),
('Небеса', 15, 'мягкий', 167, '2022-05-12'),
('Любовь в большом городе', 26, 'мягкий', 217, '2021-10-29'),
('Счастливые истории, в основном', 26, 'мягкий', 151, '2021-12-02'),
('Елена знает', 2, 'мягкий', 143, '2021-07-01'),
('Книга матери', 21, 'мягкий', 224, '2021-09-19'),
('Больше, чем я люблю свою жизнь', 9, 'мягкий', 288, '2021-08-26'),
('Фенотипы', 1, 'мягкий', 232, '2022-01-01'),
('Новое имя: Септология VI–VII', 5, 'мягкий', 228, '2021-09-08'),
('После солнца', 11, 'мягкий', 158, '2021-08-24'),
('Гробница из песка', 26, 'мягкий', 739, '2021-08-12'),
('Книги Якова', 5, 'мягкий', 920, '2021-11-15'),
('Проклятый кролик', 8, 'мягкий', 251, '2021-06-15'),
('Война бедных', 15, 'твердый', 69, '2021-01-07'),
('Когда мы перестаём понимать мир', 17, 'твердый', 192, '2020-09-03'),
('Мерзость', 1, 'мягкий', 176, '2020-06-02'),
('Опись потерь', 12, 'твердый', 256, '2020-08-20'),
('Ночью вся кровь чёрная', 17, 'твердый', 192, '2020-11-05'),
('Я живу в трущобах', 33, 'твердый', 344, '2020-05-19'),
('В память о памяти', 5, 'мягкий', 510, '2021-02-17'),
('Незначительная деталь', 5, 'мягкий', 144, '2020-05-06'),
('Летний брат', 32, 'мягкий', 285, '2021-04-08'),
('Опасности курения в постели', 6, 'мягкий', 187, '2021-04-01'),
('Сотрудники', 11, 'мягкий', 136, '2020-10-01'),
('Грушевое поле', 14, 'мягкий', 163, '2020-10-30'),
('Идеальная девятка', 25, 'твердый', 240, '2020-10-06'),
('Приключения Чайны Айрон', 2, 'мягкий', 200, '2019-11-14'),
('Неловкость вечера', 4, 'мягкий', 282, '2020-03-05'),
('Восьмая жизнь', 20, 'твердый', 944, '2019-11-14'),
('Просветление дерева мирабель', 3, 'мягкий', 256, '2020-01-17'),
('Полиция памяти', 7, 'мягкий', 277, '2019-08-15'),
('Другое имя: Септология I–II', 5, 'мягкий', 351, '2019-10-10'),
('Тилль', 18, 'твердый', 352, '2020-02-06'),
('Лица на кончике моего языка', 14, 'мягкий', 136, '2019-10-22'),
('Сезон ураганов', 5, 'мягкий', 229, '2020-02-19'),
('Маленькие глаза', 13, 'твердый', 256, '2020-04-16'),
('Мак и его проблема', 7, 'мягкий', 224, '2019-06-06'),
('Красная собака', 17, 'твердый', 432, '2019-06-06'),
('Серотонин', 31, 'твердый', 320, '2019-09-26'),
('В сумерках', 20, 'мягкий', 192, '2018-11-19'),
('Небесные тела', 19, 'мягкий', 243, '2018-05-21'),
('Веди свой плуг по костям мёртвых', 5, 'мягкий', 270, '2019-01-01'),
('Четыре солдата', 16, 'твердый', 160, '2018-10-04'),
('Шутки для стрелков', 16, 'мягкий', 162, '2019-01-03'),
('Любовь в новом тысячелетии', 33, 'твердый', 288, '2018-11-20'),
('Птичий роток', 13, 'мягкий', 228, '2019-02-07'),
('Смерть Мурата Идрисси', 20, 'твердый', 112, '2019-01-10'),
('Факультет снов', 12, 'мягкий', 338, '2019-03-21'),
('Сосновые острова', 23, 'твердый', 180, '2019-03-21'),
('Остаток', 1, 'мягкий', 193, '2018-10-04'),
('Форма руин', 12, 'твердый', 512, '2018-05-03'),
('Годы', 5, 'мягкий', 232, '2018-06-20'),
('Франкенштейн в Багдаде', 13, 'мягкий', 272, '2018-02-01'),
('Пошёл, ушёл, исчез', 16, 'твердый', 368, '2017-08-07'),
('Как исчезающая тень', 28, 'твердый', 320, '2017-11-02'),
('Седьмая функция языка', 7, 'твердый', 390, '2017-05-03'),
('Гость на ужине', 7, 'мягкий', 160, '2018-03-01'),
('Летающая гора', 22, 'твердый', 336, '2018-03-31'),
('Самозванец', 12, 'твердый', 430, '2017-11-02'),
('Украденный велосипед', 24, 'мягкий', 416, '2017-08-28'),
('Белая книга', 16, 'мягкий', 161, '2018-04-05'),
('Мир продолжается', 28, 'мягкий', 320, '2018-05-31'),
('Вернон Субютекс 1', 12, 'мягкий', 352, '2018-03-22'),
('Умри, любовь моя', 2, 'мягкий', 123, '2017-09-14'),
('Полёты', 5, 'мягкий', 410, '2017-05-17');


INSERT INTO authors_books (author_id, books_id) 
VALUES
(23, 1),
(13, 2),
(49, 3),
(27, 4),
(29, 5),
(66, 6),
(5, 7),
(44, 8),
(16, 9),
(60, 10),
(30, 11),
(4, 12),
(72, 13),
(24, 14),
(52, 15),
(62, 16),
(56, 17),
(15, 18),
(67, 19),
(19, 20),
(59, 21),
(38, 22),
(39, 23),
(28, 24),
(58, 25),
(11, 26),
(22, 27),
(10, 28),
(6, 29),
(41, 30),
(18, 31),
(12, 32),
(45, 33),
(1, 34),
(34, 35),
(46, 36),
(57, 37),
(53, 38),
(54, 39),
(25, 40),
(47, 41),
(55, 42),
(64, 43),
(71, 44),
(38, 45),
(17, 46),
(20, 47),
(24, 48),
(61, 49),
(21, 50),
(69, 51),
(51, 52),
(33, 53),
(37, 54),
(58, 55),
(32, 56),
(50, 57),
(12, 58),
(61, 59),
(65, 60),
(63, 61),
(48, 62),
(3, 63),
(40, 64),
(7, 65),
(2, 66),
(36, 67),
(8, 68),
(43, 69),
(26, 70),
(14, 71),
(35, 72),
(70, 73),
(31, 74),
(42, 75),
(68, 76),
(9, 77),
(58, 78);

INSERT INTO rating (book_id, rating) 
VALUES
(1,5),
(1,2),
(1,4),
(1,1),
(1,5),
(1,5),
(1,3),
(1,1),
(1,5),
(1,4),
(2,2),
(2,4),
(2,1),
(2,1),
(2,5),
(2,1),
(2,3),
(2,4),
(2,2),
(2,5),
(3,5),
(3,3),
(3,5),
(3,5),
(3,2),
(3,5),
(3,2),
(3,3),
(3,2),
(3,3),
(4,3),
(4,4),
(4,2),
(4,4),
(4,3),
(4,2),
(4,4),
(4,2),
(4,4),
(4,4),
(5,1),
(5,3),
(5,4),
(5,5),
(5,5),
(5,3),
(5,1),
(5,4),
(5,4),
(5,5),
(6,3),
(6,3),
(6,2),
(6,4),
(6,5),
(6,4),
(6,3),
(6,1),
(6,2),
(6,5),
(7,1),
(7,5),
(7,3),
(7,5),
(7,3),
(7,1),
(7,3),
(7,3),
(7,3),
(7,2),
(8,3),
(8,2),
(8,5),
(8,1),
(8,2),
(8,5),
(8,1),
(8,4),
(8,3),
(8,3),
(9,2),
(9,5),
(9,2),
(9,4),
(9,4),
(9,2),
(9,5),
(9,3),
(9,5),
(9,5),
(10,3),
(10,4),
(10,2),
(10,5),
(10,2),
(10,1),
(10,5),
(10,3),
(10,2),
(10,2),
(11,1),
(11,1),
(11,2),
(11,3),
(11,2),
(11,5),
(11,1),
(11,2),
(11,4),
(11,2),
(12,3),
(12,3),
(12,2),
(12,5),
(12,1),
(12,1),
(12,3),
(12,2),
(12,4),
(12,2),
(13,2),
(13,3),
(13,5),
(13,1),
(13,2),
(13,5),
(13,3),
(13,5),
(13,1),
(13,1),
(14,5),
(14,3),
(14,5),
(14,5),
(14,5),
(14,2),
(14,4),
(14,5),
(14,1),
(14,5),
(15,4),
(15,1),
(15,1),
(15,2),
(15,5),
(15,5),
(15,1),
(15,5),
(15,5),
(15,3),
(16,4),
(16,3),
(16,1),
(16,4),
(16,4),
(16,5),
(16,2),
(16,1),
(16,4),
(16,4),
(17,1),
(17,2),
(17,1),
(17,1),
(17,1),
(17,1),
(17,4),
(17,5),
(17,5),
(17,4),
(18,3),
(18,3),
(18,5),
(18,2),
(18,5),
(18,5),
(18,5),
(18,4),
(18,2),
(18,2),
(19,1),
(19,4),
(19,3),
(19,5),
(19,1),
(19,5),
(19,3),
(19,3),
(19,2),
(19,3),
(20,1),
(20,3),
(20,2),
(20,3),
(20,1),
(20,4),
(20,3),
(20,5),
(20,3),
(20,3),
(21,5),
(21,5),
(21,1),
(21,2),
(21,3),
(21,5),
(21,1),
(21,2),
(21,3),
(21,1),
(22,5),
(22,3),
(22,1),
(22,1),
(22,1),
(22,1),
(22,4),
(22,1),
(22,3),
(22,4),
(23,4),
(23,4),
(23,2),
(23,1),
(23,4),
(23,2),
(23,3),
(23,5),
(23,3),
(23,1),
(24,1),
(24,1),
(24,2),
(24,2),
(24,2),
(24,3),
(24,3),
(24,5),
(24,5),
(24,2),
(25,3),
(25,3),
(25,5),
(25,4),
(25,3),
(25,2),
(25,5),
(25,1),
(25,2),
(25,1),
(26,4),
(26,2),
(26,5),
(26,2),
(26,1),
(26,2),
(26,5),
(26,4),
(26,2),
(26,1),
(27,2),
(27,5),
(27,2),
(27,1),
(27,4),
(27,4),
(27,2),
(27,1),
(27,3),
(27,5),
(28,2),
(28,5),
(28,3),
(28,4),
(28,4),
(28,2),
(28,3),
(28,5),
(28,5),
(28,4),
(29,2),
(29,4),
(29,4),
(29,2),
(29,5),
(29,3),
(29,1),
(29,5),
(29,5),
(29,3),
(30,4),
(30,4),
(30,4),
(30,3),
(30,4),
(30,5),
(30,4),
(30,3),
(30,4),
(30,4),
(31,2),
(31,3),
(31,2),
(31,2),
(31,2),
(31,2),
(31,1),
(31,5),
(31,5),
(31,2),
(32,1),
(32,5),
(32,3),
(32,1),
(32,2),
(32,2),
(32,1),
(32,5),
(32,1),
(32,1),
(33,4),
(33,5),
(33,3),
(33,3),
(33,1),
(33,3),
(33,3),
(33,4),
(33,5),
(33,4),
(34,4),
(34,1),
(34,3),
(34,3),
(34,5),
(34,3),
(34,4),
(34,1),
(34,2),
(34,3),
(35,2),
(35,5),
(35,1),
(35,2),
(35,3),
(35,5),
(35,4),
(35,1),
(35,5),
(35,1),
(36,1),
(36,1),
(36,3),
(36,3),
(36,4),
(36,3),
(36,5),
(36,4),
(36,2),
(36,5),
(37,3),
(37,2),
(37,2),
(37,5),
(37,3),
(37,1),
(37,3),
(37,4),
(37,5),
(37,5),
(38,4),
(38,4),
(38,4),
(38,2),
(38,1),
(38,3),
(38,2),
(38,2),
(38,1),
(38,1),
(39,5),
(39,2),
(39,2),
(39,2),
(39,4),
(39,2),
(39,2),
(39,4),
(39,4),
(39,4),
(40,3),
(40,2),
(40,1),
(40,5),
(40,2),
(40,4),
(40,1),
(40,5),
(40,5),
(40,1),
(41,1),
(41,4),
(41,4),
(41,5),
(41,4),
(41,1),
(41,1),
(41,3),
(41,3),
(41,5),
(42,3),
(42,3),
(42,2),
(42,4),
(42,5),
(42,4),
(42,2),
(42,1),
(42,4),
(42,5),
(43,2),
(43,3),
(43,1),
(43,4),
(43,1),
(43,1),
(43,4),
(43,2),
(43,3),
(43,4),
(44,3),
(44,4),
(44,1),
(44,4),
(44,5),
(44,1),
(44,2),
(44,4),
(44,2),
(44,3),
(45,3),
(45,5),
(45,2),
(45,3),
(45,4),
(45,1),
(45,5),
(45,4),
(45,3),
(45,5),
(46,3),
(46,4),
(46,5),
(46,3),
(46,3),
(46,5),
(46,5),
(46,2),
(46,2),
(46,1),
(47,2),
(47,5),
(47,5),
(47,1),
(47,1),
(47,5),
(47,3),
(47,5),
(47,1),
(47,3),
(48,3),
(48,5),
(48,4),
(48,5),
(48,1),
(48,4),
(48,2),
(48,3),
(48,5),
(48,5),
(49,5),
(49,1),
(49,3),
(49,5),
(49,1),
(49,3),
(49,5),
(49,2),
(49,1),
(49,3),
(50,3),
(50,5),
(50,1),
(50,3),
(50,3),
(50,3),
(50,5),
(50,5),
(50,4),
(50,2),
(51,4),
(51,1),
(51,2),
(51,3),
(51,5),
(51,1),
(51,2),
(51,4),
(51,1),
(51,1),
(52,4),
(52,5),
(52,3),
(52,5),
(52,4),
(52,5),
(52,5),
(52,1),
(52,2),
(52,1),
(53,1),
(53,4),
(53,4),
(53,1),
(53,2),
(53,5),
(53,3),
(53,1),
(53,4),
(53,5),
(54,3),
(54,4),
(54,2),
(54,3),
(54,4),
(54,1),
(54,4),
(54,1),
(54,4),
(54,2),
(55,1),
(55,2),
(55,2),
(55,4),
(55,4),
(55,1),
(55,5),
(55,3),
(55,3),
(55,4),
(56,3),
(56,3),
(56,2),
(56,3),
(56,4),
(56,5),
(56,4),
(56,1),
(56,4),
(56,2),
(57,1),
(57,1),
(57,3),
(57,4),
(57,5),
(57,1),
(57,5),
(57,1),
(57,5),
(57,2),
(58,4),
(58,4),
(58,2),
(58,5),
(58,5),
(58,5),
(58,4),
(58,2),
(58,1),
(58,5),
(59,1),
(59,5),
(59,3),
(59,3),
(59,1),
(59,1),
(59,2),
(59,1),
(59,5),
(59,1),
(60,5),
(60,4),
(60,1),
(60,3),
(60,4),
(60,5),
(60,1),
(60,3),
(60,4),
(60,5),
(61,3),
(61,1),
(61,1),
(61,1),
(61,3),
(61,4),
(61,4),
(61,4),
(61,3),
(61,5),
(62,4),
(62,5),
(62,3),
(62,3),
(62,5),
(62,5),
(62,4),
(62,2),
(62,5),
(62,1),
(63,5),
(63,4),
(63,3),
(63,5),
(63,3),
(63,5),
(63,5),
(63,5),
(63,1),
(63,5),
(64,3),
(64,2),
(64,2),
(64,3),
(64,1),
(64,2),
(64,5),
(64,2),
(64,3),
(64,1),
(65,4),
(65,2),
(65,4),
(65,4),
(65,2),
(65,1),
(65,2),
(65,2),
(65,5),
(65,5),
(66,2),
(66,2),
(66,1),
(66,3),
(66,1),
(66,2),
(66,5),
(66,1),
(66,4),
(66,4),
(67,5),
(67,4),
(67,4),
(67,2),
(67,4),
(67,3),
(67,5),
(67,5),
(67,1),
(67,2),
(68,2),
(68,1),
(68,2),
(68,2),
(68,5),
(68,1),
(68,3),
(68,5),
(68,1),
(68,3),
(69,5),
(69,3),
(69,4),
(69,2),
(69,4),
(69,2),
(69,1),
(69,2),
(69,1),
(69,5),
(70,2),
(70,3),
(70,1),
(70,1),
(70,5),
(70,2),
(70,3),
(70,1),
(70,1),
(70,4),
(71,1),
(71,5),
(71,2),
(71,2),
(71,2),
(71,1),
(71,2),
(71,1),
(71,4),
(71,2),
(72,3),
(72,2),
(72,3),
(72,1),
(72,3),
(72,1),
(72,2),
(72,1),
(72,5),
(72,2),
(73,5),
(73,4),
(73,2),
(73,3),
(73,3),
(73,4),
(73,1),
(73,3),
(73,1),
(73,5),
(74,4),
(74,1),
(74,5),
(74,1),
(74,2),
(74,4),
(74,5),
(74,1),
(74,5),
(74,2),
(75,4),
(75,5),
(75,5),
(75,1),
(75,1),
(75,5),
(75,4),
(75,2),
(75,4),
(75,5),
(76,2),
(76,1),
(76,5),
(76,2),
(76,1),
(76,1),
(76,4),
(76,1),
(76,3),
(76,4),
(77,1),
(77,3),
(77,4),
(77,5),
(77,1),
(77,4),
(77,3),
(77,2),
(77,5),
(77,3),
(78,4),
(78,5),
(78,3),
(78,3),
(78,3),
(78,3),
(78,2),
(78,1),
(78,5),
(78,2);


INSERT INTO translator (name) 
VALUES
('Адриан Нейтан'),
('Элисон Стрейер'),
('Анджела Родел'),
('Анируддхан Васудеван'),
('Анна Мошовакис'),
('Анна МакЛин'),
('Аннелиз Файниган'),
('Антон Хур'),
('Антония Ллойд'),
('Камило Рамирес'),
('Каролина Орлофф'),
('Шарлотта Барслунд'),
('Шарлотта Коллинз'),
('Чен Зепинг'),
('Дейзи Роквелл'),
('Деймион Сирлз'),
('Даниел Хан'),
('Даниел Левин'),
('Даррил Стерк'),
('Дэвид Бойд'),
('Дэвид Догерти'),
('Дебора Браган'),
('Дебора Смит'),
('Айлин Майлз'),
('Элизабет Жакетт'),
('Элизабет Хейгвей'),
('Фиона Макинтош'),
('Фрэнсис Риддл'),
('Фрэнк Уинн'),
('Джордж Сиртс'),
('Айона Макинтайр'),
('Джеки Смит'),
('Дже Вон Чанг'),
('Джен Калледжа'),
('Дженнифер Крофт'),
('Дженнифер Хиггинс'),
('Джереми Тианг'),
('Джессика Коэн'),
('Джон Батки'),
('Джонатан Райт'),
('Карен Гернант'),
('Кэти Дербишир'),
('Лесли Камхи'),
('Маргарет Джалл'),
('Мэриллин Бут'),
('Марк Полиццотти'),
('Мартин Эйткен'),
('Меган МакДауэлл'),
('Мишель Хатчинсон'),
('Михиэль Хейнс'),
('Наташа Виммер'),
('Никола Смолли'),
('Николь Амонвиль'),
('Оттили Мулзет'),
('Рубен Вулли'),
('Ричард Филкокс'),
('Розалинд Харви'),
('Росс Бенджамин'),
('Рут Мартин'),
('Сэм Бетт'),
('Сэм Гарретт'),
('Сэм Тейлор'),
('Сара Мозес'),
('Саша Дугдейл'),
('Шон Уайтсайд'),
('Шерилин Николетт'),
('Саймон Паре'),
('Софи Хьюз'),
('Софи Льюис'),
('Сора Ким-Расселл'),
('Стивен Снайдер'),
('Сьюзен Бернофски'),
('Тиффани Цао'),
('Нгуги ва');

INSERT INTO translator_books (translator_id, book_id) 
VALUES
(53, 1),
(33, 2),
(56, 3),
(29, 4),
(3, 5),
(12, 6),
(55, 7),
(18, 8),
(42, 9),
(4, 10),
(57, 11),
(52, 12),
(37, 13),
(68, 14),
(60, 15),
(20, 15),
(8, 16),
(73, 17),
(28, 18),
(43, 19),
(38, 20),
(17, 21),
(16, 22),
(66, 23),
(15, 24),
(35, 25),
(8, 26),
(46, 27),
(1, 28),
(52, 29),
(32, 30),
(5, 31),
(41, 32),
(14, 32),
(64, 33),
(25, 34),
(21, 35),
(48, 36),
(47, 37),
(26, 38),
(74, 39),
(27, 40),
(31, 40),
(49, 41),
(13, 42),
(59, 42),
(71, 44),
(16, 45),
(58, 46),
(69, 47),
(36, 47),
(68, 48),
(48, 49),
(44, 50),
(68, 50),
(50, 51),
(65, 52),
(70, 53),
(45, 54),
(9, 55),
(62, 56),
(40, 57),
(24, 58),
(7, 58),
(48, 59),
(61, 60),
(22, 61),
(34, 62),
(68, 63),
(6, 64),
(2, 65),
(40, 66),
(72, 67),
(10, 68),
(62, 69),
(51, 70),
(67, 71),
(29, 72),
(19, 73),
(23, 74),
(54, 75),
(30, 75),
(39, 75),
(29, 76),
(63, 77),
(11, 77),
(35, 78);

---1---
select title 
from books
where id in (
 select books_id
 from authors_books
 where author_id in (
  select id 
  from authors
  where name like 'Ариана Арвис'
 )
)
;
SELECT DISTINCT b.title
FROM books b
JOIN authors_books ab ON ab.books_id = b.id
JOIN authors a ON a.id = ab.author_id
WHERE a.name = 'Ариана Арвис';
---2---
select name
from authors
where id in (
 select author_id
 from authors_books
 where books_id in (
  select id
  from books
  where title = 'Валун'
 )
);
--3--
select * 
from rating
where book_id in (
 select id
 from books
 where title = 'Пока мы мечтали'
);
--4--
select *
from books b
join publishers p on p.id=b.publisher_id;
--5--
select *
from books b
join publishers p on p.id=b.publisher_id
where p.name like 'And%';
--6--
select *
from books b
join rating r on r.book_id=b.id
where b.title = 'Парадайс';
--7--
select * 
from books b
join authors_books ab on ab.books_id=b.id
join authors a on a.id=ab.author_id;
--8--
select a.name, b.title, b.pages, b.published_date  
from books b
join authors_books ab on ab.books_id=b.id
join authors a on a.id=ab.author_id;

--9--
select b.title, round(avg(r.rating),1) as avg_rating
from books b
join rating r on r.book_id=b.id
group by title;
--10--
select b.title, round(avg(r.rating),1)
from books b
join rating r on r.book_id=b.id
group by b.title
having b.title = 'Парадайс';
--11--
select b.title, round(avg(r.rating),2) as avg_r
from books b
join rating r on r.book_id=b.id
group by b.title 
order by avg_r desc;

select * from books;
--12--
create view authors_books_view as 
select a.name, b.title, b.pages, b.published_date from authors_books
join books b on b.id=authors_books.books_id
join authors a on a.id=authors_books.author_id;

select * from authors_books_view;
--13--
select * 
from authors_books_view
where published_date >='2020-01-01' and published_date <='2020-12-31'
order by pages desc;

select * from rating;
--14--
create temporary view books_ratings_view as
SELECT 
  books.id, 
  books.title, 
  books.pages, 
  books.published_date, 
  ROUND(AVG(r.rating), 2) AS avg_rating
FROM books
JOIN rating r ON r.book_id = books.id
GROUP BY 
  books.id, books.title, books.pages, books.published_date;

select * from books_ratings_view;

--15--
select * from books_ratings_view 
order by avg_rating desc
limit 5;
--16--
select * from books;
with books_publishers_view as (
 select books.title, publishers.name from books
 join publishers on publishers.id=books.publisher_id
)
select * from books_publishers_view;

--17--
insert into authors (name, country, birthdate)
values ('Ким Чен Ын','Korea', '1984-01-08');
--18--
update authors
set name = 'Rumi', country='Persian', birthdate='1273-09-30'
where name = 'Ким Чен Ын' and country='Korea'and birthdate='1984-01-08';
--19--
delete from authors
where name = 'Rumi';


--20--
select * from books;

select title,
 case
  WHEN pages <= 100 then 'small book'
  WHEN pages <= 200 then 'medium'
  else 'big'
 end
from books;
--21--
select title, 
 case
  when format='мягкий' then 'm'
  when format='твердый' then 't'
 end
from books;


--22--
select title from books;

CREATE INDEX books_title_index
ON books(title);

--23--
CREATE PROCEDURE add_author(name text, country text, birthdate date)
LANGUAGE plpgsql
AS $$
BEGIN
    INSERT INTO authors (name, country, birthdate)
    VALUES (name, country, birthdate);
END;
$$;

CALL add_author('Касымалы Баялинов', 'Кыргызстан', '1902-09-25');
--24--
CREATE PROCEDURE add_book(title text, publisher_id int, format text, pages int, published_date date)
LANGUAGE plpgsql
AS $$
BEGIN
    INSERT INTO books (title, publisher_id, format, pages, published_date)
    VALUES (title, publisher_id, format, pages, published_date);
END;
$$;

CALL add_book('Ажар', NULL, 'твердый', 18, '1928-01-01');



